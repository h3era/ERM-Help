<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<title>Работа с памятью</title>
<LINK REL="stylesheet" MEDIA="screen" TYPE="text/css" HREF="../style.css">
</head>
<body>
<h2 align="center">Работа с памятью: UN:C<br>
<font size="3">(by Д'якон)</font></h2>
<h3>Немного теории</h3>
<p>
<b><a href="../Rec/UN.htm#C">!!UN:C</a></b> – ресивер, позволяющий как записывать, так и считывать данные по определённому адресу.<br>
Итак, для работы с данным ресивером Вам потребуется <u><b><a target="_blank" href="http://www.artmoney.ru">ArtMoney</a></b></u> и Герои3.</p>
<p>Адреса бывают статические и динамические.<br>
<b>Статические адреса</b> - это адреса ехе файла, т.е. 00401000&hellip;006АСЕС0 и 
00701000&hellip;0293512С.<br>
<b>Динамические адреса</b> – выделяются программой во время загрузки.<br>
Возможно совпадение динамических адресов в разных версиях героев (TE и WoG), а также на разных компьютерах, <b>но лучше всё же привязывать динамические адреса к 
статическим - привязку можно делать через указатели</b> (они так же бывают динамические и статические).<br>
Всё это будет рассмотрено ниже. Пока просто можете запомнить.</p>
<p><b>Что искать и как?</b><br>
На эту тему приведено масса примеров в руководстве к АртМани (поэтому начинать нужно с чтения данного руководства).<br>
<b>Памятка:</b> лучшим прерыванием процесса является команда !!IF:M^^; (дальше поясню&hellip; Вообще, с использованием ERM поиск значительно облегчается)</p>
<p><b>Что ж, я приведу пару практических примеров.</b><br>
Начнём с простенького.</p>
<h3>Задача 1: найти адрес, содержащий ресурс &quot;золото&quot;.</h3>
<p>Данная задача является наиболее простой. Ресурс отображается в определённом значении, значит и искать мы будем &quot;точное значение&quot;.<br>
Создайте карту для экспериментов, где Вам не будут мешать противники. (не обязательно, но желательно). Запустите игру. Запустите Вашу карту 
(у Вас должен быть хотя бы замок, либо золотая шахта - для того, чтобы золото меняло значение). Запомните значение ресурса. Нажмите <i class="key">Alt</i>+<i class="key">Tab</i>. Запустите АртМани.</p>
<ol>
<li>Выберите процесс:<br>
<img src="../Img/unc/Art1.png" width="500" height="323"></li>

<li>Нажмите на кнопку искать. И выберите: &quot;точное значение&quot; , введите кол-во золота, и выберите &quot;Целые (стандартные)&quot; 
(к последнему и следующим пунктам в меню поиска ещё вернёмся).<br>
<img src="../Img/unc/Art2.png" width="500" height="319"><br>
<img src="../Img/unc/Art3.png" width="500" height="321"><br>
<img src="../Img/unc/Art4.png" width="500" height="321"></li>

<li>Нажимаем ОК. В левом поле отобразятся все найденные адреса с заданным значением. В моём случае при значении золота 20000 - 542 адреса.<br>
<img src="../Img/unc/Art5.png" width="500" height="320"></li>

<li>Нажимаем <i class="key">Alt</i>+<i class="key">Tab</i>. Возвращаемся в игру и пропускаем ход. Золото увеличилось (у меня 20500).</li>

<li><i class="key">Alt</i>+<i class="key">Tab</i>. Нажимаем на кнопку &quot;Отсеять&quot;. И вводим в поле новое значение золота. 
Нажимаем ОК. Остался 1 адрес. Это и есть адрес, по которому содержится значение золото. Значение целое - 4 байта. 
Т.е. при использовании UN:C записываем или считываем 4 байта. Полученный адрес - в 16-чной системе исчисления, переводим в 10ричную 
(можно при помощи стандартного калькулятора Windows), для записи в UN:C.<br>
<img src="../Img/unc/Art6.png" width="500" height="321"><br>
<img src="../Img/unc/Art7.png" width="500" height="320"><br>
<img src="../Img/unc/Art8.png" width="500" height="305">
</li></ol>
<p><b>Вывод: определится с целью поиска, постараться чтобы в игре изменялся только этот параметр.</b></p>

<p>Ну вот, с первым примером закончили.</p>
<h3>Задача2: найти адрес содержащий стоимость постройки в городе.</h3>
<p>Сложность данной задачи заключается в том, что стоимость постройки есть константа.</p>
<ol>
<li>Запускаем Героев. Запускаем АртМани. (В данном примере возьмём Конфлюкс).</li>
<li>Цену лучше искать по золоту, т.к. получаем меньше адресов. Поиск по другим ресурсам даст более 30000 адресов, что не очень удобно.</li>
<li>Итак. Смотрим стоимость первого, допустим, жилища - 300 золота и по 5 дерева и руды. В поиске выбираем: &quot;точное значение&quot;, &quot;300&quot;, &quot;Целые (стандартные)&quot;. 
Выполняем поиск. Найдено 376 адресов.</li>
<li>Добавляем все адреса в правое поле. Если адресов больше тысячи, то нужно изменить значение отображаемых адресов в правом поле. 
Данная опция находится в меню &quot;искать&quot;, в &quot;настройках&quot; в закладке &quot;дополнительные&quot;. И перезапустить АртМани.<br>
<img src="../Img/unc/Art9.png" width="500" height="323"><br>
<img src="../Img/unc/Art10.png" width="500" height="299"></li>
<li>Т.к. адресов в данном случае не более 376, то выставлять данную опцию не следует (а вообще, рекомендую поставить сразу тысяч на 8-10 для удобства).</li>
<li>После добавления адресов в правое поле выбираем следующее: &quot;изменить&quot; - &quot;выбрать всё&quot;. 
Далее в контекстном меню выделенных адресов выбираем &quot;установить значение&quot; 1 с шагом 1. Можете увидеть, как становились значения в адресах. 
Далее заходим в игру и смотрим цену жилища. Цена в золоте 85. Находим адрес со значением 85 - это и будет наш искомый адрес 06АА4D8. 
Для того, чтобы найти адреса дерева и руды войдём в меню адреса, двойной щелчок на адресе и при помощи скроллинга стрелками вниз (т.е. на уменьшение адреса) будем искать необходимые значения, т.е. 5 и 5. Можно заметить, что ресурсы между собой находятся на смещении равном 4. 
Соответственно, дерево находится на смешении 24 от золота 06АА4С0. В этом легко убедиться, вычтя из адреса золота адрес дерева и переведя в 10-чную систему исчисления.<br>
<img src="../Img/unc/Art11.png" width="500" height="318"><br>
<img src="../Img/unc/Art12.png" width="500" height="344"><br>
<img src="../Img/unc/Art13.png" width="500" height="317"><br>
<img src="../Img/unc/Art14.png" width="500" height="319"><br>
<img src="../Img/unc/Art15.png" width="500" height="373"><br>
<img src="../Img/unc/Art16.png" width="500" height="232"><br>
<img src="../Img/unc/Art17.png" width="500" height="340"></li>
</ol>
<p><b>Вывод: обычно похожие по смыслу значения хранятся в близком диапазоне - блоке 
памяти или массиве значений. Чтобы найти отклонения между значениями, в данном 
случае между значением стоимости жилищ, нужно найти ещё значение стоимости 
второго жилища и найти разницу между адресами. Можно быть уверенным, что и 
остальные стоимости жилищ находятся на одинаковом смещении друг от друга.</b></p>

</body></html>